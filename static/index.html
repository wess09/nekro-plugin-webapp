<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebApp éƒ¨ç½²ç®¡ç†</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        #app {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #666;
            font-size: 0.9em;
        }

        .status {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85em;
            margin-top: 1rem;
        }

        .status.healthy {
            background: #4caf50;
            color: white;
        }

        .status.error {
            background: #f44336;
            color: white;
        }

        .status.warning {
            background: #ff9800;
            color: white;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card h2 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 1.3em;
        }

        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.2s;
        }

        .button:hover {
            background: #5568d3;
        }

        .button.danger {
            background: #f44336;
        }

        .button.danger:hover {
            background: #da190b;
        }

        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.3rem;
            color: #555;
            font-size: 0.9em;
        }

        .input-group input {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .key-item, .page-item {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: #f9f9f9;
        }

        .key-item-header, .page-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .key-name, .page-title {
            font-weight: 600;
            color: #333;
        }

        .key-id, .page-id {
            font-family: monospace;
            font-size: 0.85em;
            color: #666;
        }

        .key-info, .page-info {
            font-size: 0.85em;
            color: #777;
            margin-top: 0.5rem;
        }

        .key-value {
            background: #f5f5f5;
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85em;
            word-break: break-all;
            margin-top: 0.5rem;
            border: 1px dashed #ddd;
        }

        .button-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .button-group button {
            padding: 0.4rem 0.8rem;
            font-size: 0.85em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 0.3rem;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #999;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-size: 0.9em;
            z-index: 1000;
            animation: slideIn 0.3s;
        }

        .toast.success {
            background: #4caf50;
        }

        .toast.error {
            background: #f44336;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .setup-guide {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .setup-guide h3 {
            color: #856404;
            margin-bottom: 0.5rem;
            font-size: 1em;
        }

        .setup-guide ol {
            margin-left: 1.5rem;
            color: #856404;
        }

        .setup-guide li {
            margin: 0.5rem 0;
            font-size: 0.9em;
        }

        .setup-guide code {
            background: #fff;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>ğŸš€ WebApp éƒ¨ç½²ç®¡ç†</h1>
            <p class="subtitle">é€šè¿‡ Cloudflare Workers å¿«é€Ÿéƒ¨ç½² HTML åº”ç”¨</p>
            <div class="status" :class="healthStatus.class">
                {{ healthStatus.text }}
            </div>
        </div>

        <!-- ç®¡ç†å‘˜å¯†é’¥è¾“å…¥ -->
        <div class="card" v-if="workerConfigured && !adminKey">
            <h2>ğŸ” è¾“å…¥ç®¡ç†å‘˜å¯†é’¥</h2>
            <p style="margin-bottom: 1rem; color: #666;">
                è¯·è¾“å…¥åœ¨æ’ä»¶é…ç½®ä¸­è®¾ç½®çš„ç®¡ç†å‘˜å¯†é’¥ï¼Œä»¥ç®¡ç†é¡µé¢å’Œå¯†é’¥ã€‚
                å¯†é’¥å°†ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ä¸­ã€‚
            </p>
            <div class="input-group">
                <label>ç®¡ç†å‘˜å¯†é’¥</label>
                <input v-model="adminKey" type="password" placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†é’¥" @keyup.enter="saveAdminKey" />
            </div>
            <button class="button" @click="saveAdminKey">
                ä¿å­˜å¹¶ç»§ç»­
            </button>
            <p style="margin-top: 1rem; font-size: 0.85em; color: #999;">
                æç¤ºï¼šå¦‚æœä½¿ç”¨çš„æ˜¯é»˜è®¤å¯†é’¥ï¼Œè¯·è¾“å…¥ "admin-change-me-immediately"
            </p>
        </div>

        <!-- è®¾ç½®æŒ‡å— -->
        <div class="card" v-if="!workerConfigured">
            <h2>ğŸ“– éƒ¨ç½²æŒ‡å—</h2>
            <div class="setup-guide">
                <h3>å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿå®Œæˆï¼‰</h3>
                <ol>
                    <li>è®¿é—® <a href="https://dash.cloudflare.com/" target="_blank">Cloudflare Dashboard</a>ï¼Œç™»å½•æˆ–æ³¨å†Œè´¦å·</li>
                    <li>åœ¨å·¦ä¾§èœå•é€‰æ‹© <code>Workers & Pages</code></li>
                    <li>ç‚¹å‡» <code>Create application</code> â†’ <code>Create Worker</code></li>
                    <li>ç‚¹å‡» <code>Connect to Git</code>ï¼Œè¿æ¥æ­¤ä»“åº“ï¼ˆ<code>nekro-plugin-webapp</code>ï¼‰</li>
                    <li>Cloudflare ä¼šè‡ªåŠ¨è¯†åˆ« <code>worker/</code> ç›®å½•å¹¶éƒ¨ç½²</li>
                    <li>åœ¨ Worker è®¾ç½®ä¸­åˆ›å»º D1 æ•°æ®åº“ï¼š
                        <ul>
                            <li>Settings â†’ Variables â†’ D1 database bindings</li>
                            <li>ç‚¹å‡» <code>Add binding</code></li>
                            <li>Variable name: <code>DB</code></li>
                            <li>ç‚¹å‡» <code>Create new database</code>ï¼Œåç§°å¡« <code>webapp-db</code></li>
                        </ul>
                    </li>
                    <li>è®¾ç½®ç¯å¢ƒå˜é‡ <code>ADMIN_KEY_HASH</code>ï¼š
                        <ul>
                            <li>åœ¨ Settings â†’ Variables â†’ Environment Variables</li>
                            <li>ç‚¹å‡» <code>Add variable</code></li>
                            <li>Name: <code>ADMIN_KEY_HASH</code></li>
                            <li>Value: ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥çš„ SHA-256 å“ˆå¸Œï¼ˆè§ä¸‹æ–¹å·¥å…·ï¼‰</li>
                            <li>å‹¾é€‰ <code>Encrypt</code></li>
                        </ul>
                    </li>
                    <li>åˆå§‹åŒ–æ•°æ®åº“ï¼šåœ¨ Worker çš„ D1 database é¡µé¢ï¼Œæ‰§è¡Œ <code>worker/schema.sql</code> ä¸­çš„ SQL</li>
                    <li>å¤åˆ¶ Worker URL å’Œç®¡ç†å‘˜å¯†é’¥ï¼Œå¡«å†™åˆ° NekroAgent æ’ä»¶é…ç½®ä¸­</li>
                </ol>
                
                <h3 style="margin-top: 1rem;">ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥</h3>
                <div class="input-group">
                    <button class="button" @click="generateAdminKey">ç”Ÿæˆæ–°å¯†é’¥</button>
                </div>
                <div v-if="generatedKey.key">
                    <div class="key-value">
                        <strong>å¯†é’¥ï¼ˆä¿å­˜å¥½ï¼Œä»…æ˜¾ç¤ºä¸€æ¬¡ï¼‰ï¼š</strong><br>
                        {{ generatedKey.key }}
                    </div>
                    <div class="key-value" style="margin-top: 0.5rem;">
                        <strong>SHA-256 å“ˆå¸Œï¼ˆå¡«å…¥ç¯å¢ƒå˜é‡ï¼‰ï¼š</strong><br>
                        {{ generatedKey.hash }}
                    </div>
                    <button class="button" @click="copyToClipboard(generatedKey.hash)" style="margin-top: 0.5rem;">
                        å¤åˆ¶å“ˆå¸Œå€¼
                    </button>
                </div>
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="card" v-if="workerConfigured">
            <h2>ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</h2>
            <div v-if="stats" class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">{{ stats.pages_count }}</div>
                    <div class="stat-label">æ€»é¡µé¢æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ stats.keys_count }}</div>
                    <div class="stat-label">æ´»è·ƒå¯†é’¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ stats.total_access }}</div>
                    <div class="stat-label">æ€»è®¿é—®æ¬¡æ•°</div>
                </div>
            </div>
            <div v-else class="loading">åŠ è½½ä¸­...</div>
        </div>

        <!-- å¯†é’¥ç®¡ç† -->
        <div class="card" v-if="workerConfigured">
            <h2>ğŸ”‘ API å¯†é’¥ç®¡ç†</h2>
            
            <div class="input-group">
                <label>å¯†é’¥åç§°</label>
                <input v-model="newKeyName" placeholder="ä¾‹å¦‚ï¼šå›¢é˜Ÿå…±äº«å¯†é’¥" />
            </div>
            <button class="button" @click="createKey" :disabled="!newKeyName.trim()">
                åˆ›å»ºæ–°å¯†é’¥
            </button>

            <div v-if="loading.keys" class="loading">åŠ è½½ä¸­...</div>
            <div v-else-if="keys.length === 0" class="empty-state">
                æš‚æ— å¯†é’¥ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»º
            </div>
            <div v-else style="margin-top: 1.5rem;">
                <div v-for="key in keys" :key="key.key_id" class="key-item">
                    <div class="key-item-header">
                        <div>
                            <div class="key-name">{{ key.key_name }}</div>
                            <div class="key-id">ID: {{ key.key_id }}</div>
                        </div>
                        <button class="button danger" @click="deleteKey(key.key_id)">
                            åˆ é™¤
                        </button>
                    </div>
                    <div class="key-info">
                        åˆ›å»ºæ—¶é—´: {{ formatDate(key.created_at) }} | 
                        ä½¿ç”¨æ¬¡æ•°: {{ key.usage_count }} | 
                        æƒé™: {{ key.permissions }}
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡µé¢ç®¡ç† -->
        <div class="card" v-if="workerConfigured">
            <h2>ğŸ“„ å·²éƒ¨ç½²é¡µé¢</h2>
            
            <div v-if="loading.pages" class="loading">åŠ è½½ä¸­...</div>
            <div v-else-if="pages.length === 0" class="empty-state">
                æš‚æ— é¡µé¢ï¼Œä½¿ç”¨ AI è°ƒç”¨æ’ä»¶åˆ›å»ºç¬¬ä¸€ä¸ªé¡µé¢
            </div>
            <div v-else>
                <div v-for="page in pages" :key="page.page_id" class="page-item">
                    <div class="page-item-header">
                        <div>
                            <div class="page-title">{{ page.title }}</div>
                            <div class="page-id">{{ page.description }}</div>
                        </div>
                        <div class="button-group">
                            <button class="button" @click="openPage(page.page_id)">
                                è®¿é—®
                            </button>
                            <button class="button danger" @click="deletePage(page.page_id)">
                                åˆ é™¤
                            </button>
                        </div>
                    </div>
                    <div class="page-info">
                        ID: {{ page.page_id }} | 
                        åˆ›å»º: {{ formatDate(page.created_at) }} | 
                        è®¿é—®: {{ page.access_count }}æ¬¡
                        <span v-if="page.expires_at"> | è¿‡æœŸ: {{ formatDate(page.expires_at) }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast æç¤º -->
        <div v-if="toast.show" class="toast" :class="toast.type">
            {{ toast.message }}
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    workerUrl: '',
                    adminKey: '',
                    workerConfigured: false,
                    healthStatus: { text: 'æ£€æŸ¥ä¸­...', class: 'warning' },
                    stats: null,
                    keys: [],
                    pages: [],
                    newKeyName: '',
                    generatedKey: { key: '', hash: '' },
                    loading: {
                        keys: false,
                        pages: false,
                    },
                    toast: {
                        show: false,
                        type: 'success',
                        message: '',
                    },
                };
            },
            mounted() {
                this.checkHealth();
                this.loadConfig();
            },
            methods: {
                async checkHealth() {
                    try {
                        const response = await fetch('/plugins/nekro_plugin_webapp/health');
                        const data = await response.json();
                        
                        if (data.status === 'healthy') {
                            this.healthStatus = { text: 'âœ… Worker è¿è¡Œæ­£å¸¸', class: 'healthy' };
                            this.workerConfigured = true;
                            
                            // è‡ªåŠ¨è·å– Worker URL å’Œå¯†é’¥
                            if (data.worker_url) {
                                this.workerUrl = data.worker_url;
                            }
                            
                            // æ³¨æ„ï¼šç®¡ç†å‘˜å¯†é’¥ä¸ä¼šé€šè¿‡ API ä¼ è¾“ï¼Œéœ€è¦ç”¨æˆ·åœ¨é¡µé¢ä¸Šæ‰‹åŠ¨è¾“å…¥
                            // æˆ–è€…ä»æµè§ˆå™¨æœ¬åœ°å­˜å‚¨åŠ è½½
                            const storedKey = localStorage.getItem('webapp_admin_key');
                            if (storedKey) {
                                this.adminKey = storedKey;
                            }
                            
                            this.loadData();
                        } else if (data.status === 'not_configured') {
                            this.healthStatus = { text: 'âš ï¸ æœªé…ç½® Worker', class: 'warning' };
                        } else {
                            this.healthStatus = { text: 'âŒ Worker æ— æ³•è®¿é—®', class: 'error' };
                        }
                    } catch (error) {
                        this.healthStatus = { text: 'âŒ æ£€æŸ¥å¤±è´¥', class: 'error' };
                    }
                },
                async loadData() {
                    await Promise.all([
                        this.loadStats(),
                        this.loadKeys(),
                        this.loadPages(),
                    ]);
                },
                async loadConfig() {
                    // é…ç½®åœ¨ checkHealth() ä¸­å·²ç»åŠ è½½
                },
                saveAdminKey() {
                    if (this.adminKey && this.adminKey.trim()) {
                        localStorage.setItem('webapp_admin_key', this.adminKey);
                        this.showToast('ç®¡ç†å‘˜å¯†é’¥å·²ä¿å­˜åˆ°æµè§ˆå™¨', 'success');
                        this.loadData();
                    }
                },
                async loadStats() {
                    if (!this.workerUrl || !this.adminKey) return;
                    
                    try {
                        const response = await fetch(`${this.workerUrl}/admin/stats`, {
                            headers: {
                                'Authorization': `Bearer ${this.adminKey}`
                            }
                        });
                        
                        if (response.ok) {
                            this.stats = await response.json();
                        }
                    } catch (error) {
                        console.error('Failed to load stats:', error);
                    }
                },
                async loadKeys() {
                    if (!this.workerUrl || !this.adminKey) return;
                    
                    this.loading.keys = true;
                    try {
                        const response = await fetch(`${this.workerUrl}/admin/keys`, {
                            headers: {
                                'Authorization': `Bearer ${this.adminKey}`
                            }
                        });
                        
                        if (response.ok) {
                            this.keys = await response.json();
                        } else {
                            throw new Error('Failed to load keys');
                        }
                    } catch (error) {
                        console.error('Failed to load keys:', error);
                        this.showToast('åŠ è½½å¯†é’¥å¤±è´¥', 'error');
                    } finally {
                        this.loading.keys = false;
                    }
                },
                async loadPages() {
                    if (!this.workerUrl || !this.adminKey) return;
                    
                    this.loading.pages = true;
                    try {
                        const response = await fetch(`${this.workerUrl}/admin/pages`, {
                            headers: {
                                'Authorization': `Bearer ${this.adminKey}`
                            }
                        });
                        
                        if (response.ok) {
                            this.pages = await response.json();
                        } else {
                            throw new Error('Failed to load pages');
                        }
                    } catch (error) {
                        console.error('Failed to load pages:', error);
                        this.showToast('åŠ è½½é¡µé¢å¤±è´¥', 'error');
                    } finally {
                        this.loading.pages = false;
                    }
                },
                async generateAdminKey() {
                    // ç”Ÿæˆéšæœºå¯†é’¥
                    const array = new Uint8Array(32);
                    crypto.getRandomValues(array);
                    const key = btoa(String.fromCharCode.apply(null, array))
                        .replace(/\+/g, '-')
                        .replace(/\//g, '_')
                        .replace(/=/g, '');
                    
                    // è®¡ç®— SHA-256
                    const encoder = new TextEncoder();
                    const data = encoder.encode(key);
                    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    const hash = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                    
                    this.generatedKey = { key, hash };
                },
                async createKey() {
                    if (!this.newKeyName.trim()) {
                        this.showToast('è¯·è¾“å…¥å¯†é’¥åç§°', 'error');
                        return;
                    }
                    
                    if (!this.workerUrl || !this.adminKey) {
                        this.showToast('æœªé…ç½® Worker', 'error');
                        return;
                    }
                    
                    try {
                        const response = await fetch(`${this.workerUrl}/admin/keys`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${this.adminKey}`
                            },
                            body: JSON.stringify({
                                key_name: this.newKeyName
                            })
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            this.showToast('å¯†é’¥åˆ›å»ºæˆåŠŸ', 'success');
                            this.newKeyName = '';
                            
                            // æ˜¾ç¤ºæ–°åˆ›å»ºçš„å¯†é’¥ï¼ˆä»…æ­¤ä¸€æ¬¡ï¼‰
                            alert(`æ–°å¯†é’¥åˆ›å»ºæˆåŠŸï¼\n\nå¯†é’¥ï¼ˆä»…æ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·ä¿å­˜ï¼‰ï¼š\n${data.api_key}\n\nå¯†é’¥IDï¼š${data.key_id}`);
                            
                            await this.loadKeys();
                        } else {
                            const error = await response.json();
                            throw new Error(error.error || 'åˆ›å»ºå¤±è´¥');
                        }
                    } catch (error) {
                        console.error('Failed to create key:', error);
                        this.showToast('åˆ›å»ºå¯†é’¥å¤±è´¥: ' + error.message, 'error');
                    }
                },
                async deleteKey(keyId) {
                    if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯†é’¥å—ï¼Ÿåˆ é™¤åå°†æ— æ³•æ¢å¤ã€‚')) return;
                    
                    if (!this.workerUrl || !this.adminKey) return;
                    
                    try {
                        const response = await fetch(`${this.workerUrl}/admin/keys/${keyId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${this.adminKey}`
                            }
                        });
                        
                        if (response.ok) {
                            this.showToast('å¯†é’¥å·²åˆ é™¤', 'success');
                            await this.loadKeys();
                        } else {
                            throw new Error('åˆ é™¤å¤±è´¥');
                        }
                    } catch (error) {
                        console.error('Failed to delete key:', error);
                        this.showToast('åˆ é™¤å¯†é’¥å¤±è´¥', 'error');
                    }
                },
                async deletePage(pageId) {
                    if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡µé¢å—ï¼Ÿåˆ é™¤åè®¿é—®é“¾æ¥å°†å¤±æ•ˆã€‚')) return;
                    
                    if (!this.workerUrl || !this.adminKey) return;
                    
                    try {
                        const response = await fetch(`${this.workerUrl}/api/pages/${pageId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${this.adminKey}`
                            }
                        });
                        
                        if (response.ok) {
                            this.showToast('é¡µé¢å·²åˆ é™¤', 'success');
                            await this.loadPages();
                            await this.loadStats();
                        } else {
                            throw new Error('åˆ é™¤å¤±è´¥');
                        }
                    } catch (error) {
                        console.error('Failed to delete page:', error);
                        this.showToast('åˆ é™¤é¡µé¢å¤±è´¥', 'error');
                    }
                },
                openPage(pageId) {
                    if (!this.workerUrl) {
                        this.showToast('Worker URL æœªé…ç½®', 'error');
                        return;
                    }
                    // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€é¡µé¢
                    const url = `${this.workerUrl}/${pageId}`;
                    window.open(url, '_blank');
                },
                async copyToClipboard(text) {
                    try {
                        await navigator.clipboard.writeText(text);
                        this.showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                    } catch (error) {
                        this.showToast('å¤åˆ¶å¤±è´¥', 'error');
                    }
                },
                formatDate(timestamp) {
                    if (!timestamp) return '-';
                    const date = new Date(timestamp);
                    return date.toLocaleString('zh-CN');
                },
                showToast(message, type = 'success') {
                    this.toast = { show: true, message, type };
                    setTimeout(() => {
                        this.toast.show = false;
                    }, 3000);
                },
            },
        }).mount('#app');
    </script>
</body>
</html>

